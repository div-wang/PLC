
        <!DOCTYPE html>
        <html>
        <head>
            <meta charset="UTF-8">
            <title>PLC连接设置</title>
            <script src="qrc:///qtwebchannel/qwebchannel.js"></script>
            <style>
                body {
                    font-family: Arial, sans-serif;
                    margin: 0;
                    padding: 20px;
                    background-color: #f9f9f9;
                }
                .settings-container {
                    background-color: white;
                    border-radius: 5px;
                    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
                    padding: 20px;
                }
                .setting-group {
                    margin-bottom: 30px;
                }
                .setting-group-title {
                    font-size: 18px;
                    font-weight: bold;
                    color: #333;
                    margin-bottom: 15px;
                    padding-bottom: 10px;
                    border-bottom: 1px solid #eee;
                }
                .setting-item {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding: 12px 0;
                    border-bottom: 1px solid #f5f5f5;
                }
                .setting-item:last-child {
                    border-bottom: none;
                }
                .setting-label {
                    font-weight: 500;
                    color: #333;
                }
                .setting-desc {
                    color: #999;
                    font-size: 13px;
                    margin-top: 3px;
                }
                .setting-control {
                    width: 200px;
                    margin-right: 10px;
                    text-align: right;
                }
                .setting-control input,
                .setting-control select {
                    width: 100%;
                    box-sizing: border-box;
                    padding: 8px 10px;
                    border: 1px solid #d9d9d9;
                    border-radius: 4px;
                    font-size: 14px;
                    height: 34px;
                }
                .save-btn {
                    background-color: #1890ff;
                    color: white;
                    border: none;
                    padding: 10px 20px;
                    border-radius: 4px;
                    cursor: pointer;
                    font-size: 14px;
                    margin-top: 20px;
                    float: right;
                }
                .save-btn:hover {
                    background-color: #40a9ff;
                }
            </style>
        </head>
        <body>
            <div class="settings-container">
                <div class="setting-group">
                    <div class="setting-group-title">PLC连接设置</div>
                    
                    <div class="setting-item">
                        <div>
                            <div class="setting-label">设备类型</div>
                            <div class="setting-desc">PLC设备类型</div>
                        </div>
                        <div class="setting-control">
                            <select id="device_type">
                                <option value="S7">S7</option>
                                <option value="sqllite">sqllite</option>
                                <option value="MySQL">MySQL</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="setting-item">
                        <div>
                            <div class="setting-label">字节顺序</div>
                            <div class="setting-desc">数据字节顺序</div>
                        </div>
                        <div class="setting-control">
                            <select id="byte_order">
                                <option value="ABCD">ABCD</option>
                                <option value="CDAB">CDAB</option>
                                <option value="BADC">BADC</option>
                                <option value="DCBA">DCBA</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="setting-item">
                        <div>
                            <div class="setting-label">心跳周期</div>
                            <div class="setting-desc">心跳周期(1-1000)</div>
                        </div>
                        <div class="setting-control">
                            <input id="heartbeat" type="number" min="1" max="1000">
                        </div>
                    </div>
                    
                    <div class="setting-item">
                        <div>
                            <div class="setting-label">读写超时(毫秒)</div>
                            <div class="setting-desc">读写超时时间(1000-30000)</div>
                        </div>
                        <div class="setting-control">
                            <input id="timeout" type="number" min="1000" max="30000">
                        </div>
                    </div>
                    
                    <div class="setting-item">
                        <div>
                            <div class="setting-label">刷新间隔(毫秒)</div>
                            <div class="setting-desc">数据刷新间隔(100-10000)</div>
                        </div>
                        <div class="setting-control">
                            <input id="refresh_ms" type="number" min="100" max="100000">
                        </div>
                    </div>
                    
                    <div class="setting-item">
                        <div>
                            <div class="setting-label">地址</div>
                            <div class="setting-desc">PLC连接地址(不可为空)</div>
                        </div>
                        <div class="setting-control">
                            <input id="address" type="text">
                        </div>
                    </div>
                    
                    <div class="setting-item">
                        <div>
                            <div class="setting-label">端口号</div>
                            <div class="setting-desc">PLC连接端口(不可为空)</div>
                        </div>
                        <div class="setting-control">
                            <input id="port" type="number">
                        </div>
                    </div>
                    
                    <div class="setting-item">
                        <div>
                            <div class="setting-label">用户名</div>
                            <div class="setting-desc">连接用户名(可为空)</div>
                        </div>
                        <div class="setting-control">
                            <input id="username" type="text">
                        </div>
                    </div>
                    
                    <div class="setting-item">
                        <div>
                            <div class="setting-label">密码</div>
                            <div class="setting-desc">连接密码(可为空)</div>
                        </div>
                        <div class="setting-control">
                            <input id="password" type="password">
                        </div>
                    </div>
                </div>
                
                <button class="save-btn" id="saveBtn">保存连接设置</button>
                <div style="clear: both;"></div>
            </div>
            
            <script>
            // 初始化值
            var settings = {
                device_type: "S7",
                byte_order: "ABCD",
                heartbeat: 30,
                timeout: 10000,
                refresh_ms: 60000,
                address: "192.168.1.10",
                port: 102,
                username: "",
                password: ""
            };
            
            function initValues() {
                var dt = document.getElementById('device_type');
                if(dt) dt.value = settings.device_type;
                
                var bo = document.getElementById('byte_order');
                if(bo) bo.value = settings.byte_order;
                
                document.getElementById('heartbeat').value = settings.heartbeat;
                document.getElementById('timeout').value = settings.timeout;
                document.getElementById('refresh_ms').value = settings.refresh_ms;
                document.getElementById('address').value = settings.address;
                document.getElementById('port').value = settings.port;
                document.getElementById('username').value = settings.username;
                document.getElementById('password').value = settings.password;
            }

            document.addEventListener('DOMContentLoaded', function(){
                initValues();
                
                new QWebChannel(qt.webChannelTransport, function(channel){
                    window.bridge = channel.objects.bridge;
                    
                    document.getElementById('saveBtn').addEventListener('click', function(){
                        var data = {
                            device_type: document.getElementById('device_type').value,
                            byte_order: document.getElementById('byte_order').value,
                            heartbeat: parseInt(document.getElementById('heartbeat').value),
                            timeout: parseInt(document.getElementById('timeout').value),
                            refresh_ms: parseInt(document.getElementById('refresh_ms').value),
                            address: document.getElementById('address').value,
                            port: parseInt(document.getElementById('port').value),
                            username: document.getElementById('username').value,
                            password: document.getElementById('password').value
                        };
                        
                        bridge.saveSettings(
                            data.device_type, data.byte_order, data.heartbeat, 
                            data.timeout, data.refresh_ms, data.address, 
                            data.port, data.username, data.password
                        );
                        alert('连接设置已保存');
                    });
                });
            });
            </script>
        </body>
        </html>
        